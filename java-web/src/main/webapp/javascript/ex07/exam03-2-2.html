<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ex07</title>
</head>
<body>
<h1>AJAX - 동기 요청의 한계를 해결하자!</h1>
<button id="btn1">요청</button><br>
<a href="http://www.google.com">구글로 이동</a><br>
<textarea id="ta" cols="80" rows="10"></textarea>

<script>
var ta = document.querySelector("#ta");

document.querySelector("#btn1").onclick = () => {
    var xhr = new XMLHttpRequest();
    // 서버에서 응답이 왔을 때 호출될 메서드를 등록한다.
    // 서버에 연결하기 전에 등록해야 한다.
    // 즉 open()을 호출하기 전에 등록해야 한다.
    xhr.onreadystatechange = () => {
        console.log("서버에서 응답이 왔나?")
    };
    
    // 비동기 요청을 하려면 3번 파라미터를 true로 설정해야 한다.
    xhr.open("GET", "test3.jsp", true);
    xhr.send();
    console.log("send() 리턴함.");
    
    window.setTimeout(()=> {
       ta.value = xhr.responseText;
    }, 15000);
    
    // 해결책?
    // => 서버에서 응답을 완료했을 때 결과를 꺼내라!
    //
    // 서버가 언제 응답을 완료했는지 알수 있는가?
    // => 위에서 설정한 onreadystatechange 함수에서 검사할 수 있다. 
};

</script>
</body>
</html>





